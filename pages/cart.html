<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giỏ hàng - Fuwa3e</title>
    <link href="../css/cart.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../image/icon/themify-icons/themify-icons.css">
</head>
<body>
    <div class="header">
        <div class="header__top">
          <!-- menu cho tablet, moble -->
          <div class="header__hamburger" id="hamburger-icon">
            <i class="ti-menu"></i>
          </div>
          <!-- menu cho tablet, moble -->
      
            <div class="header__logo">
              <img src="/image/logo/NEU_logo.svg" alt="" class="header__brand-logo">
              <img src="/image/logo/gnc_logo.svg" alt="" class="header__brand-logo">
              <img src="/image/logo/fuwa3e-logo.svg" style="width: 9.5rem;" alt="" class="header__brand-logo">
            </div>
            <div class="header__navigation">
              <ul class="header__nav-list">
                <li class="header__nav-item">
                  <a href="/index.html" class="header__nav-link">
                    Trang chủ
                    <i class="ti-home"></i>
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/products.html" class="header__nav-link">
                    Sản phẩm/Dịch vụ
                    <i class="ti-shopping-cart-full"></i>
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="#" class="header__nav-link">  
                    Tin tức
                    <i class="ti-bell"></i>
                    <i class="ti-angle-double-down"></i>
                  </a>
                  <ul class="header__subnav">
                    <li class="header_subnav-item">
                      <a href="/pages/introduce.html" class="header__subnav-link">
                        Giới thiệu
                      </a>
                    </li>
                    <li class="header_subnav-item">
                      <a href="/pages/news.html" class="header__subnav-link">
                        Tin tức
                      </a>
                    </li>
                    <li class="header_subnav-item">
                      <a href="/pages/events.html" class="header__subnav-link">Sự kiện</a>
                    </li>
                    <li class="header_subnav-item">
                      <a href="/pages/research.html" class="header__subnav-link">
                        Nghiên cứu
                      </a>
                    </li>
                  </ul>
                </li>
                <li class="header__nav-item">
                  <a href="#" class="header__nav-link">
                    Hỗ trợ 
                    <i class="ti-headphone-alt"></i>
                    <i class="ti-angle-double-down"></i>
                  </a>
                  <ul class="header__subnav">
                    <li class="header__subnav-item">
                      <a href="/pages/contact.html" class="header__subnav-link">Liên hệ</a>
                    </li>
                    <li class="header_subnav-item">
                      <a href="/pages/fag.html" class="header__subnav-link">FAQ</a>
                    </li>
                  </ul>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/recruitment.html" class="header__nav-link">Tuyển dụng</a>
                </li>
              </ul>
            </div>
            <div class="header__action-item">
              <a title="Đăng nhập" href="/pages/login.html" class="header__action-button">
                <i class="ti-user"></i>
              </a>
              <a title="Giỏ hàng" href="/pages/cart.html" class="header__action-button">               
                  <i class="ti-shopping-cart"></i>
                  <span class="cart-count">0</span>
              </a>
            </div>
        </div>
      </div>
      <div class="mobile__overlay"></div>
      <div class="mobile">
            <div class="mobile__menu">
              <ul class="header__nav-list">
                <li class="header__nav-item">
                  <a href="/index.html" class="header__nav-link">
                    Trang chủ
                    
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/products.html" class="header__nav-link">
                    Sản phẩm/Dịch vụ
                   
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/news.html" class="header__nav-link">  
                    Tin tức
                   
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/introduce.html" class="header__nav-link">
                    Giới thiệu
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/research.html" class="header__nav-link">
                    Nghiên cứu
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/events.html" class="header__nav-link">
                    Sự kiện
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/contact.html" class="header__nav-link">
                    Liên hệ
              
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/fag.html" class="header__nav-link">
                    FAQ
                  </a>
                </li>
                <li class="header__nav-item">
                  <a href="/pages/recruitment.html" class="header__nav-link">Tuyển dụng</a>
                </li>
              </ul>
            </div>
      </div>
      
      
    <div class="cart-container">
        <div class="cart-header">
            <h1>Giỏ hàng của bạn</h1>
            <div class="cart-steps">
                <div class="step active">
                    <div class="step-number">1</div>
                    <div class="step-text">Giỏ hàng</div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-text">Thanh toán</div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-text">Hoàn tất</div>
                </div>
            </div>
        </div>

        <div class="cart-content">
            <div class="cart-items">
                <div class="cart-item-header">
                    <div class="header-product">Sản phẩm</div>
                    <div>Đơn giá</div>
                    <div>Số lượng</div>
                    <div>Thành tiền</div>
                    <div></div>
                </div>
                <div id="cart-items-list"></div>
            </div>

            <div class="cart-summary">
                <div class="summary-header">
                    <h3>Tóm tắt đơn hàng</h3>
                </div>
                <div class="summary-content">
                    <div class="summary-row">
                        <span>Tạm tính</span>
                        <span id="subtotal">0đ</span>
                    </div>
                    <div class="summary-row">
                        <span>Phí vận chuyển</span>
                        <span id="shipping-fee">0đ</span>
                    </div>
                    <div class="summary-row discount">
                        <span>Giảm giá</span>
                        <span id="discount">0đ</span>
                    </div>
                    <div class="summary-row total">
                        <span>Tổng cộng</span>
                        <span id="total">0đ</span>
                    </div>
                </div>
                <div class="coupon-section">
                    <input type="text" class="coupon-input" placeholder="Mã giảm giá">
                    <button class="coupon-btn">Áp dụng</button>
                </div>
                <button class="checkout-btn">Tiến hành thanh toán</button>
                <div class="continue-shopping">
                    <a href="/pages/products.html"><i class="ti-arrow-left"></i> Tiếp tục mua sắm</a>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="footer__container">
            <div class="footer__column footer__column--info">
                <h4 class="footer__title">VĂN PHÒNG FUWA</h4>
                <ul class="footer__list">
                    <li class="footer__item"><strong>Nhà máy:</strong> 04 Đồng Cổ, Phường Hàm Rồng, TP Thanh Hóa, Tỉnh Thanh Hóa</li>
                    <li class="footer__item"><strong>TP.HCM:</strong> 09 Đỗ Thừa Tự, Phường Tân Quý, Quận Tân Phú, TP. Hồ Chí Minh</li>
                    <li class="footer__item"><strong>Hà Nội:</strong> Số 2 Ngách 23 Ngõ 62 Nguyễn Chí Thanh, Quận Đống Đa, TP. Hà Nội</li>
                    <li class="footer__item"><strong>Đà Nẵng:</strong> 114 Đường Văn An, Phường Mân Thái, Quận Sơn Trà, TP. Đà Nẵng</li>
                    <li class="footer__item"><strong>VP Đức:</strong> Ziehtlenbühndweg 22a, 77704 Oberkirch, Baden-Württemberg, Deutschland</li>
                </ul>
            </div>
            <div class="footer__column footer__column--policy">
                <h4 class="footer__title">CHÍNH SÁCH FUWA</h4>
                <ul class="footer__list">
                    <li class="footer__item">Chính sách bán hàng</li>
                    <li class="footer__item">Điều khoản sử dụng</li>
                    <li class="footer__item">Điểm bán hàng</li>
                </ul>
            </div>
            <div class="footer__column footer__column--contact">
                <h4 class="footer__title">THÔNG TIN LIÊN HỆ</h4>
                <p class="footer__item"><i class="ti-headphone-alt"></i> Kinh Doanh: 0972.377.898 (Hotline)</p>
            </div>
            <div class="footer__column footer__column--links">
                <h4 class="footer__title">WEBSITE LIÊN KẾT</h4>
                <div class="footer__logos">
                    <a href="#" class="footer__logo-link">
                        <img src="/image/homepage/footer-ecoenzyme.jpg" alt="EcoEnzyme" class="footer__logo">
                    </a>
                    <a href="#" class="footer__logo-link">
                        <img src="/image/homepage/footer-sweet-boss.jpg" alt="SweetieBoss" class="footer__logo">
                    </a>
                    <a href="#" class="footer__logo-link">
                        <img src="/image/homepage/footer-refill3er.jpg" alt="Refill Station" class="footer__logo">
                    </a>
                </div>
            </div>
            <div class="footer__column footer__column--social">
                <h4 class="footer__title">KẾT NỐI VỚI FUWA</h4>
                <div class="footer__social-icons">
                    <a href="#" class="footer__icon"><i class="ti-facebook"></i></a>
                    <a href="#" class="footer__icon"><i class="ti-world"></i></a>
                    <a href="#" class="footer__icon"><i class="ti-instagram"></i></a>
                    <a href="#" class="footer__icon"><i class="ti-music-alt"></i></a>
                    <a href="#" class="footer__icon"><i class="ti-youtube"></i></a>
                    <a href="#" class="footer__icon"><i class="ti-linkedin"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        function updateCartCount() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            let cartCount = document.querySelector('.cart-count');
            cartCount.textContent = totalItems;
        }

        function loadCartItems() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartItemsList = document.getElementById('cart-items-list');

            if (cart.length === 0) {
                cartItemsList.innerHTML = `
                    <div class="cart-empty">
                        <div class="empty-icon"><i class="ti-shopping-cart"></i></div>
                        <h3>Giỏ hàng trống</h3>
                        <p>Hãy thêm sản phẩm vào giỏ hàng để tiếp tục mua sắm!</p>
                        <a href="/pages/products.html" class="btn-continue">Tiếp tục mua sắm</a>
                    </div>
                `;
                updateSummary();
                return;
            }

            cartItemsList.innerHTML = '';
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="item-product">
                        <img src="${item.img}" alt="${item.name}">
                        <div class="product-info">
                            <h3>${item.name}</h3>
                            <p>${item.categoryId}</p>
                        </div>
                    </div>
                    <div class="item-price">${item.price}.000đ</div>
                    <div class="item-quantity">
                        <button class="quantity-btn minus">-</button>
                        <input type="number" class="quantity-input" value="${item.quantity}" min="1">
                        <button class="quantity-btn plus">+</button>
                    </div>
                    <div class="item-total">${(item.price * item.quantity)}.000đ</div>
                    <div class="item-action">
                        <button class="remove-btn" data-id="${item.id}"><i class="ti-trash"></i></button>
                    </div>
                `;
                cartItemsList.appendChild(cartItem);

                // Handle quantity changes
                const minusBtn = cartItem.querySelector('.quantity-btn.minus');
                const plusBtn = cartItem.querySelector('.quantity-btn.plus');
                const quantityInput = cartItem.querySelector('.quantity-input');

                minusBtn.addEventListener('click', () => {
                    let value = parseInt(quantityInput.value);
                    if (value > 1) {
                        quantityInput.value = value - 1;
                        updateCartItem(item.id, value - 1);
                    }
                });

                plusBtn.addEventListener('click', () => {
                    let value = parseInt(quantityInput.value);
                    quantityInput.value = value + 1;
                    updateCartItem(item.id, value + 1);
                });

                quantityInput.addEventListener('change', () => {
                    let value = parseInt(quantityInput.value);
                    if (isNaN(value) || value < 1) {
                        quantityInput.value = 1;
                        value = 1;
                    }
                    updateCartItem(item.id, value);
                });

                // Handle remove item
                cartItem.querySelector('.remove-btn').addEventListener('click', () => {
                    removeCartItem(item.id);
                });
            });

            updateSummary();
        }

        function updateCartItem(id, quantity) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const itemIndex = cart.findIndex(item => item.id === id);
            if (itemIndex >= 0) {
                cart[itemIndex].quantity = quantity;
                localStorage.setItem('cart', JSON.stringify(cart));
                loadCartItems();
                updateCartCount();
            }
        }

        function removeCartItem(id) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart = cart.filter(item => item.id !== id);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCartItems();
            updateCartCount();
        }

        function updateSummary() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shippingFee = subtotal > 0 ? 30 : 0; // Example shipping fee
            const discount = 0; // Example discount
            const total = subtotal + shippingFee - discount;

            document.getElementById('subtotal').textContent = `${subtotal}.000đ`;
            document.getElementById('shipping-fee').textContent = `${shippingFee}.000đ`;
            document.getElementById('discount').textContent = `${discount}.000đ`;
            document.getElementById('total').textContent = `${total}.000đ`;
        }
        // Hàm hiển thị pop-up thanh toán thành công
        function showSuccessModal() {
            const modal = document.createElement('div');
            modal.className = 'success-modal';
            modal.innerHTML = `
                <div class="success-modal-content">
                    <h3>Thanh toán thành công!</h3>
                    <p>Cảm ơn bạn đã mua sắm tại Fuwa3e. Đơn hàng của bạn đã được xử lý.</p>
                    <button class="btn-continue">Tiếp tục mua sắm</button>
                </div>
            `;

            document.body.appendChild(modal);

            modal.querySelector('.btn-continue').addEventListener('click', () => {
                document.body.removeChild(modal);
                window.location.href = '/pages/products.html'; // Chuyển hướng về trang sản phẩm
            });

            setTimeout(() => {
                if (document.body.contains(modal)) {
                    document.body.removeChild(modal);
                    window.location.href = '/pages/products.html';
                }
            }, 5000);
        }

        // Hàm xóa toàn bộ giỏ hàng
        function clearCart() {
            localStorage.removeItem('cart');
            loadCartItems();
            updateCartCount();
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            updateCartCount();
            loadCartItems();
            

            // Xử lý nút áp dụng mã giảm giá (chức năng placeholder)
            document.querySelector('.coupon-btn').addEventListener('click', () => {
                const couponInput = document.querySelector('.coupon-input').value;
                alert(`Áp dụng mã giảm giá: ${couponInput} (Chức năng này chưa được triển khai)`);
            });

            // Xử lý nút thanh toán
            document.querySelector('.checkout-btn').addEventListener('click', () => {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                if (cart.length === 0) {
                    alert('Giỏ hàng trống! Vui lòng thêm sản phẩm trước khi thanh toán.');
                    return;
                }

                // Hiển thị pop-up thanh toán thành công
                showSuccessModal();

                // Xóa toàn bộ giỏ hàng
                clearCart();
            });
        });
    </script>
    <script src="/js/script.js" ></script>
</body>
</html>